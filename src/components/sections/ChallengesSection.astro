---
import type { ProcessedSection } from '@/types/contentful-v2';
import { ArrowRightIcon } from 'lucide-react';
import Section from '@/components/Section.astro';
import { documentToHtmlString } from '@contentful/rich-text-html-renderer';
import { Image } from 'astro:assets';
import UnlockPaceImage from '@/assets/unlock-pace.svg';
import P6MResourcesImage from '@/assets/p6m-resources.svg';
import SuccessFlexiblePlatformImage from '@/assets/success-flexible-platform.svg';

interface Props {
  section: ProcessedSection;
}

const { section } = Astro.props;

// Default images for challenges (can be overridden by section.items[i].image)
const defaultImages = [UnlockPaceImage, P6MResourcesImage, SuccessFlexiblePlatformImage];
---

<Section title={section.title || ''}>
  <div class="flex justify-between items-center gap-8 mb-8">
    {section.headline && (
      <h2 class="text-3xl md:text-4xl font-medium mb-6 max-w-sm">
        {section.headline}
      </h2>
    )}
    
    <div class="rounded-full bg-brand-purple flex items-center justify-center w-8 h-8">
      <ArrowRightIcon className="current-color w-4 h-4 mx-2" />
    </div>

    {section.description && (
      <div class="max-w-lg font-mono">
        {typeof section.description === 'string' 
          ? section.description 
          : documentToHtmlString(section.description)}
      </div>
    )}
  </div>

  <div class="grid md:grid-cols-3 gap-8">
    {section.items?.map((item, index) => (
      <div>
        {item.image ? (
          <img src={item.image.url} alt={item.image.alt} class="w-full" />
        ) : defaultImages[index] && (
          <Image src={defaultImages[index]} alt={item.title || `Challenge ${index + 1}`} class="w-full" />
        )}
        <div>
          {item.title && (
            <h3 class="font-normal text-lg mb-2">
              {item.title}
            </h3>
          )}
          {item.description && (
            <p class="text-xs text-gray-600 font-mono">
              {typeof item.description === 'string' 
                ? item.description 
                : documentToHtmlString(item.description)}
            </p>
          )}
        </div>
      </div>
    ))}
  </div>
</Section>

