---
import type { ProcessedSection } from "@/types/contentful-v2";
import { ArrowDownIcon, ArrowRight, ArrowRightCircle } from "@lucide/astro";
import { documentToHtmlString } from "@contentful/rich-text-html-renderer";
import { ArrowRightIcon } from "@lucide/astro";
import { Image } from "astro:assets";
import aicpaSoc from "@/assets/aicpa-soc-logo.png";

interface Props {
  section: ProcessedSection;
}

const { section } = Astro.props;

// Process description if it's rich text
const description =
  typeof section.description === "string"
    ? section.description
    : section.description
      ? documentToHtmlString(section.description)
      : "";
---

<section class="container mx-auto px-6 md:py-8 py-4">
  <div class="has-circle-end border-l border-gray-900 pb-7">
    <ArrowDownIcon class="w-3 h-3 absolute -bottom-1 -left-[6.5px]" />
    {
      section.title && (
        <div class="border-gray-900 pl-6 mb-2">
          <div class="font-mono text-sm text-gray-600 -translate-y-2.5">
            {section.title}
          </div>
        </div>
      )
    }
    <div
      class="bg-dark-gradient text-white p-6 md:p-12 rounded-lg rounded-l-none"
    >
      <div
        class="flex justify-between flex-col md:flex-row md:items-center gap-8"
      >
        {
          section.headline && (
            <h2 class="text-3xl md:text-4xl">{section.headline}</h2>
          )
        }

        <div
          class="rounded-full flex items-center justify-center w-8 h-8 bg-brand-purple transform rotate-90 md:rotate-0"
        >
          <ArrowRightIcon class="text-primary w-4 h-4 mx-2" />
        </div>

        <div class="flex flex-col gap-4 items-start">
          <div class="flex gap-4 items-center">
             <Image src={aicpaSoc} alt="AICPA SOC" width={60} height={60} quality={100} />
            {
              section.description && (
                <div
                  class="text-sm text-white font-mono flex flex-col gap-4 max-w-lg"
                  set:html={documentToHtmlString(section.description)}
                />
              )
            }
          </div>
  
          <a href="https://security.ybor.ai" target="_blank" class="bg-white flex text-foreground rounded-full py-1.5 px-4 items-center justify-center">
            Security Trust Center <ArrowRight class="w-4 h-4 mx-2 text-brand-purple" />
          </a>
        </div>
      </div>
    </div>
  </div>
</section>
