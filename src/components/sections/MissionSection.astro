---
import type { ProcessedSection } from '@/types/contentful-v2';
import { ArrowDownIcon } from 'lucide-react';
import { documentToHtmlString } from '@contentful/rich-text-html-renderer';
import { decodeHtmlEntities } from '@/lib/utils';
import { ArrowRightIcon } from '@lucide/astro';

interface Props {
  section: ProcessedSection;
}

const { section } = Astro.props;

// Process description if it's rich text
const description = typeof section.description === 'string' 
  ? section.description 
  : section.description 
    ? decodeHtmlEntities(documentToHtmlString(section.description))
    : '';
---

<section class="container mx-auto px-6 py-8">
  <div class="has-circle-end border-l border-gray-900 pb-7">
    <ArrowDownIcon className="w-3 h-3 absolute -bottom-1 -left-[6.5px]" />
    {section.title && (
      <div class="border-gray-900 pl-6 mb-2">
        <div class="font-mono text-sm text-gray-600 -translate-y-2.5">
          {section.title}
        </div>
      </div>
    )}
    <div class="bg-dark-gradient text-white p-12 rounded-lg rounded-l-none">
      <div class="flex justify-between items-center gap-8">
        {
          section.headline && (
            <h2 class="text-3xl md:text-4xl font-medium">
              {section.headline}
            </h2>
          )
        }
    
        <div
        class="rounded-full flex items-center justify-center w-8 h-8 bg-brand-purple"
        >
          <ArrowRightIcon class="current-color w-4 h-4 mx-2" />
        </div>
    
        {
          section.description && (
            <div
              class="max-w-lg font-mono text-sm text-white"
              set:html={decodeHtmlEntities(
                documentToHtmlString(section.description)
              )}
            />
          )
        }
      </div>
    </div>
    
  </div>
</section>

